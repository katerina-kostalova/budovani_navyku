



{% extends "base.html" %}

{% block title %}
    {{ habit.name }}
{% endblock %}


{% block content %}
    <h1 class="display-4">{{ habit.name }}</h1>
    <p class="lead">
            Kategorie:{% comment %}jsou to kolekce{% endcomment %}
            {% for category in habit.categories.all %}
                {{ category }}
            {% empty %}
                Nen√≠ dafinovan√° ≈æ√°dn√° kategorie pro tento n√°vyk.
            {% endfor %}
    </p>

    <div class="habit-images">
        {% for image in habit.images.all %}
            <span class="habit-image">
                <img src="{{ image.image.url }}"
                     alt="{{ image.description }}"
                     width="300px">
            </span>
        {% endfor %}
    </div>

    <hr class="my-4">
    <div class="row">
        <div class="col-md-6">
            <p><strong>P≈ôek√°≈æka:</strong>
                {% for obstacle in habit.obstacles.all %}
                    <span class="badge badge-secondary">{{ obstacle }}</span>
                {% empty %}
                    Nen√≠ dafinovan√° ≈æ√°dn√° p≈ôek√°≈æka pro tento n√°vyk.
                {% endfor %}
            </p>
            <p><strong>Odmƒõna:</strong>
                {% for reward in habit.rewards.all %}
                    {{ reward }}
                {% empty %}
                    Nen√≠ dafinovan√° ≈æ√°dn√° odmƒõna pro tento n√°vyk.
                {% endfor %}
            </p>
            <p><strong>Jak ƒçasto:</strong>{{ habit.frequency }}</p>
            <p><strong>C√≠l:</strong>{{ habit.goal }}</p>
        </div>
        <div class="col-md-6">
            <p><strong>C√≠l opakov√°n√≠:</strong>{{ habit.target_repetitions }}</p>
            <p><strong>Zaƒç√≠m√°n dne:</strong>{{ habit.start_date }}</p>
            <p><strong>Status:</strong>{{ habit.status }}</p>
            <p><strong>Pr≈Ømƒõrn√© hodnocen√≠</strong>
                {% if rating_avg %}
                    {{ rating_avg }} ({{ rating_count }})</p>
                {% else %}
                    Zat√≠m nehodnoceno
                {% endif %}
        </div>
        <p><strong>Popis:</strong></p>
        <p class="text-justify">{{ habit.description }}</p>










        <br>
        <p class="mt-3"><small class="text-muted>">P≈ôid√°no dne: {{ habit.created_at|date:"j. n. Y G:i"}}</small></p>
        <p><small class="text-muted>">Posledn√≠ √∫prava dne: {{ habit.updated_at|date:"j. n. Y G:i" }}</small></p>
    </div>

    <p>
        {% if habit in profile.acquired_habit.all %}
            <a href="{% url 'acquired_habit' habit.id %}"> ‚úÖ done Odebrat z osvojen√Ωch n√°vyk≈Ø</a>
        {% else %}
            <a href="{% url 'acquired_habit' habit.id %}"> üìå P≈ôidat k osvojen√Ωm n√°vyk≈Øm</a>
        {% endif %}
    </p>


    <p>
        {% if habit in profile.targeted_habit.all %}
            <a href="{% url 'targeted_habit' habit.id %}"> üéØ Odebrat z c√≠lov√Ωch n√°vyk≈Ø</a>
        {% else %}
            <a href="{% url 'targeted_habit' habit.id %}"> üéØ P≈ôidat k c√≠lov√Ωm n√°vyk≈Øm</a>
        {% endif %}
    </p>


    <hr>
    {% if perms.viewer.change_habit %}
        <a href="{% url 'habit_update' habit.id %}" class="btn btn-primary">Aktualizovat</a>
    {% endif %}
    {% if perms.viewer.delete_habit %}
        <a href="{% url 'habit_delete' habit.id %}" class="btn btn-danger">Smazat</a>
    {% endif %}

    {% if request.user.is_authenticated %}
            <form action="" method="post">
                {% csrf_token %}
                <table>{{ review_form.as_table }}</table>
                <button type="submit">Odeslat</button>
            </form>
    {% endif %}

    <hr>
    {% for review in habit.reviews.all %}
        <div class="bg-light rounded mt-2 p-2 position-relative">
            <span>U≈æivatel: {{ review.reviewer }}</span>
            <span class="font-italic">{{ review.created|date:'d.m.Y H:i'  }}</span>
            {% if review.created != review.updated %}
                <span class="font-italic">(upraveno {{ review.updated|date:'d.m.Y H:i' }}</span>
            {% endif %}
            {% if request.user == review.reviewer.user %}
                <a href="{% url 'review_delete' review.id %}">Smazat</a>
            {% endif %}





            <div>
                Hodnocen√≠: {{ review.rating }}
            </div>
            <div>
                Koment√°≈ô: {{ review.comment }}
            </div>
        </div>
    {% empty %}
        Zat√≠m nen√≠ evidov√°no ≈æ√°dn√© hodnocen√≠.
    {% endfor %}
{% endblock %}


